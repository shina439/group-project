<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shift Tracker</title>
<style>
    body { font-family: Arial, sans-serif; background: #f4f6f8; display: flex; justify-content: center; align-items: center; height: 100vh; }
    form { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); width: 300px; }
    h2 { text-align: center; }
    select, button { width: 100%; padding: 10px; margin: 8px 0; border-radius: 5px; border: 1px solid #ccc; }
    button { background: #007bff; color: white; border: none; cursor: pointer; }
    button:hover { background: #0056b3; }
    #status { text-align: center; font-weight: bold; }
</style>
</head>
<body>
<form>
    <h2>Shift Tracker</h2>
    <div id="status"></div>
    <select id="userSelect"></select>
    <button type="button" id="checkInBtn">Check In</button>
    <button type="button" id="checkOutBtn">Check Out</button>
</form>

<script>
function loadUsers() {
    const users = JSON.parse(localStorage.getItem("users")) || [];
    const select = document.getElementById("userSelect");
    select.innerHTML = "";
    users.forEach(u => {
        const opt = document.createElement("option");
        opt.value = u.username;
        opt.textContent = u.username;
        select.appendChild(opt);
    });
}

function saveShiftRecord(record) {
    let shifts = JSON.parse(localStorage.getItem("shifts")) || [];
    shifts.push(record);
    localStorage.setItem("shifts", JSON.stringify(shifts));
}

document.getElementById("checkInBtn").addEventListener("click", () => {
    const name = document.getElementById("userSelect").value;
    const start = new Date().toISOString();
    saveShiftRecord({ name, start, end: null, hours: null, date: new Date().toLocaleDateString() });
    document.getElementById("status").textContent = `${name} checked in at ${new Date(start).toLocaleTimeString()}`;
});

document.getElementById("checkOutBtn").addEventListener("click", () => {
    const name = document.getElementById("userSelect").value;
    let shifts = JSON.parse(localStorage.getItem("shifts")) || [];
    const today = new Date().toLocaleDateString();
    const record = shifts.find(r => r.name === name && r.date === today && !r.end);
    if(record) {
        record.end = new Date().toISOString();
        const diff = (new Date(record.end) - new Date(record.start)) / (1000*60*60);
        record.hours = diff.toFixed(2);
        localStorage.setItem("shifts", JSON.stringify(shifts));
        document.getElementById("status").textContent = `${name} checked out at ${new Date(record.end).toLocaleTimeString()} (Worked ${record.hours} hrs)`;
    } else {
        alert("No active shift found for this user today.");
    }
});

loadUsers();
</script>
</body>
</html>
